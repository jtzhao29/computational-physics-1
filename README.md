# 题目描述
### A．虫口模型与Logistic映射

1．对于迭代方程

$$
x_{n+1}=1-\mu x_n^2
$$


分析不同的 $\mu \in(0,2)$ 下 $x_n$ 的长时间行为，以及其与初值 $x_0 \in(-1,1)$ 的关系。（2分）

2．将上述的方程换成

$$
x_{n+1}=\cos x-\mu x_n^2
$$


合理选择 $\mu, x_0$ 的区间，并分析 $x_n$ 的长时间行为。（1分）
3．比较两种情况，你发现了什么？（1分）

### B．开心消消乐

在一个 $L \times L$ 的网格（即每行每列均有 $L$ 个格子）上定义如下的消消乐游戏：
1．在最开始，格子上没有任何的方块。
2．每次挑选任意一个格子，放上去一个方块。每放上去一个方块，系统开始演化一个时间步。一个时间步内的演化规则见后面一条。
3．如果一个格子上的方块数目大于等于 4 ，则消去 4 个方块，并记录一次消去，这四个方块会移动累加到上下左右的 4 个格点（它们各自方块数 +1 ），（如果有一个方块的两个邻居同时消去并给到它，则它的方块数量 +2 ，也就是说影响是叠加的；考虑开放边界条件，即如果一个格子在边界发生消去，则有一个或者两个方块移动出去了）。每次同时消去所有当前高度大于等于 4 的格子，并记录下总的消去次数。直到场上没有任何格子的方块数 $\geq 4$ ，这一个时间步结束。
4．每一步的得分 $s$ 即为这一步的总消去次数。



1. 选取网格大小 $L=32$ ，演化足够多的时间步，并记录网格平均方块密度 $n$（ $n=\frac{N}{L^2}$ ，其中 $N$ 是场上的方块总数）随着演化时间 $t$ 的关系。你发现了什么？（2分）
2. 选取并固定一个合适的系统尺寸 $L$（取决于你的计算能力），统计长时间演化时，每步得分的频率分布 $P(s)$ 。你发现了什么规律？（2分）
3. 选取多个不同的系统尺寸 $L$ 重复（2）的过程，验证你发现的统计规律。系统的尺寸对这一规律有什么影响？（1分）
4. 你能解释你在（B）中发现的规律吗？有什么别的思考？（1分）

# 算法浅析
### A．虫口模型与Logistic映射
本题目考察了迭代方程和Logistic映射的一些性质。该题所用算法简单，将$x_n$的值代入方程，得到新的$x_{n+1}$值，重复这一过程，即可得到$x_n$的序列。

具体来说，本程序通过`logistic_map`重复这一过程，并将$x_n$序列的值输出。

### B．开心消消乐
本题的实现关键在于如何快速找到大于等于4的格子，也即需要消去的格子。

在`B.py`中，我们使用了一个`numpy`数组来表示网格，并在`exist_4_or_more`对x,y坐标进行检索，找到大于等于4的格子。

在`B_tree.py`中，我使用深度搜索(BFS)的方法进行搜索，找到大于等于4的格子。伪代码如下：

```python
def find_4_or_more(L,gridll,x,y,s):
    if gridll[x][y] < 4:    
        return 
    if gridll[x][y] >=4 :
        delete_block(L,gridll,x,y)
        s[0] += 1
        if x >=1:
            find_4_or_more(L,gridll,x-1,y,s)
        if x < L-1: 
            find_4_or_more(L,gridll,x+1,y,s)
        if y >=1:
            find_4_or_more(L,gridll,x,y-1,s)
        if y < L-1:
            find_4_or_more(L,gridll,x,y+1,s) 
```

# 结果及分析
### A．虫口模型与Logistic映射
####  迭代方程一（$x_{n+1}=1-\mu x_n^2$）

不妨选取$x_0=0.5$，选取$\mu=0.01，0.5，1，1.5，1.99$，画出$x_n$的长时间行为。代码运行结果如下：
![x_0=0.5](E:/大二下/computational physics/homework/hw_1/figure/A_0.5.png)

![x_0=0.5](./figure/A_0.5.png)

由上图可以看出，当$\mu$很小的时候，$x_n$迅速收敛到一个稳定值；当$\mu$增大的同时，$x_n$的收敛速度变慢或难以收敛，$x_n$的波动幅度变大，呈现出更多的无规律性、无周期性。

不妨选取不同的$x_0$，画出$x_n$的长时间行为，研究其与$x_0$初值的关系：

$x_0=0$:
![$x_0=0$](.\figure\A_0.png) 

$x_0=-0.5$:
![$x_0=-0.5$](.\figure\A_-0.5.png) 




# 附录：源码
### A．虫口模型与Logistic映射


```python

```









